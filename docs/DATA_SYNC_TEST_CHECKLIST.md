# 数据同步功能 - 测试检查清单

## 前端菜单和路由测试

### 菜单显示
- [ ] 系统管理菜单正确显示
- [ ] "数据同步"菜单项在"汇率管理"下方显示
- [ ] "数据同步"菜单使用正确的图标（同步图标）
- [ ] 鼠标悬停在菜单项上有提示文本
- [ ] 菜单在响应式布局中正确显示

### 路由导航
- [ ] 点击菜单项能正确导航到 `/admin/data-sync`
- [ ] 直接输入 URL `http://localhost:3001/admin/data-sync` 能正确跳转
- [ ] 页面返回按钮工作正常
- [ ] 刷新页面菜单项保持选中状态

### 页面加载
- [ ] 页面标题显示为"数据同步"
- [ ] 三个标签页都正确显示（同步任务、数据源、同步日志）
- [ ] 页面加载过程中显示加载状态
- [ ] 页面加载完成后显示相应的表格数据

---

## 同步任务标签页测试

### 新建任务功能
- [ ] "新建任务"按钮点击后打开对话框
- [ ] 对话框标题正确显示"新建同步任务"
- [ ] 所有必填字段都有红色 * 标记
- [ ] 任务名称输入框可以正常输入
- [ ] 数据源下拉框显示可用的数据源选项
- [ ] 调度方式下拉框显示三个选项（手动/定期/定时）
- [ ] 当选择"定期"时，显示"间隔（分钟）"输入框
- [ ] 当选择"定时"时，显示"Cron 表达式"输入框
- [ ] 当选择"手动"时，两个调度参数输入框都隐藏
- [ ] 回溯天数输入框可以输入数字
- [ ] 覆盖已有数据开关可以打开/关闭
- [ ] 启用此任务开关可以打开/关闭
- [ ] 点击"确定"按钮保存任务
- [ ] 点击"取消"按钮关闭对话框，不保存任何数据

### 任务列表显示
- [ ] 任务列表表格正确显示所有字段
  - [ ] 任务名称
  - [ ] 数据源
  - [ ] 调度方式
  - [ ] 启用/禁用状态
  - [ ] 最后运行时间
  - [ ] 最后结果状态
- [ ] 表格有分页功能
- [ ] 表格支持横向滚动（在小屏幕上）
- [ ] 状态标签颜色正确（启用为绿色，禁用为红色）
- [ ] 执行结果标签颜色正确（成功为绿色，失败为红色）

### 任务编辑功能
- [ ] 点击编辑按钮打开编辑对话框
- [ ] 对话框标题显示"编辑同步任务"
- [ ] 对话框预填充任务的当前配置信息
- [ ] 修改配置后点击"确定"保存更改
- [ ] 保存后表格数据自动更新

### 任务删除功能
- [ ] 点击删除按钮弹出确认对话框
- [ ] 确认对话框显示"确定要删除这个同步任务吗？"
- [ ] 点击"确定"按钮删除任务，表格数据自动更新
- [ ] 点击"取消"按钮不删除任务

### 任务运行功能
- [ ] 点击播放按钮触发任务执行
- [ ] 点击时显示加载状态
- [ ] 执行完成后显示成功/失败提示
- [ ] 页面自动刷新任务列表和日志列表
- [ ] 显示正确的错误信息（如果执行失败）

---

## 数据源标签页测试

### 数据源列表显示
- [ ] 表格显示所有可用数据源
- [ ] 表格列包括：名称、提供商、状态、最后同步
- [ ] 数据源状态标签颜色正确（启用为绿色，禁用为红色）
- [ ] 最后同步时间显示正确的日期格式（YYYY-MM-DD HH:mm）
- [ ] 表格有分页功能
- [ ] 未同步的数据源显示"未同步"

### 数据加载
- [ ] 页面初始加载时获取数据源列表
- [ ] 加载过程显示加载状态
- [ ] 加载失败时显示错误提示或默认值
- [ ] 可以手动刷新数据源列表

---

## 同步日志标签页测试

### 日志列表显示
- [ ] 表格显示同步日志
- [ ] 表格列包括：任务名称、数据源、状态、记录数、成功数、失败数、开始时间、耗时
- [ ] 状态标签颜色正确
  - [ ] 成功：绿色
  - [ ] 失败：红色
  - [ ] 运行中：蓝色动画
- [ ] 日期时间显示正确的格式（YYYY-MM-DD HH:mm:ss）
- [ ] 耗时以秒为单位显示
- [ ] 表格有分页功能
- [ ] 表格支持横向滚动（在小屏幕上）

### 日志数据刷新
- [ ] 页面初始加载时获取日志列表
- [ ] 执行任务后自动刷新日志列表
- [ ] 加载失败时显示错误提示或空表格
- [ ] 可以手动刷新日志列表

---

## 价格管理中心页面测试

### 标签页验证
- [ ] 不再显示"API自动同步"标签页
- [ ] 保留以下三个标签页：
  - [ ] 单产品多日录入
  - [ ] 多产品单日录入
  - [ ] 批量导入
- [ ] 切换标签页时内容正确加载
- [ ] 标签页的图标显示正确

### 功能完整性
- [ ] 单产品多日录入功能正常工作
- [ ] 多产品单日录入功能正常工作
- [ ] 批量导入功能正常工作
- [ ] 没有任何功能丢失或损坏

---

## 错误处理和边界情况测试

### 网络错误处理
- [ ] 网络连接失败时显示合适的错误提示
- [ ] 后端超时时显示"请求超时"提示
- [ ] API 返回错误时显示错误信息
- [ ] 用户可以点击重试按钮重新加载

### 表单验证
- [ ] 提交空白表单时显示必填字段提示
- [ ] 输入非数字时数字字段显示错误
- [ ] Cron 表达式格式错误时显示提示（如果有验证）
- [ ] 所有验证错误清晰可见

### 边界情况
- [ ] 任务列表为空时显示"暂无数据"
- [ ] 数据源列表为空时显示"暂无数据"
- [ ] 日志列表为空时显示"暂无数据"
- [ ] 任务名称很长时正确换行或截断
- [ ] 大量数据时表格分页正常工作
- [ ] 表格滚动时性能正常

---

## 权限和认证测试

### 权限验证
- [ ] 未登录用户无法访问数据同步页面
- [ ] 未登录用户被重定向到登录页
- [ ] 登录后可以正常访问所有功能
- [ ] 没有调整权限系统（因为数据同步对所有登录用户开放）

### 认证 Token
- [ ] 所有 API 请求都包含 Authorization header
- [ ] Token 格式正确：`Bearer <token>`
- [ ] Token 过期时显示"请重新登录"
- [ ] 用户可以重新登录后继续使用

---

## 响应式设计测试

### 桌面版 (> 1200px)
- [ ] 所有表格列完整显示
- [ ] 菜单正常显示
- [ ] 按钮和控件正常显示

### 平板版 (768px - 1200px)
- [ ] 表格能够水平滚动
- [ ] 菜单可能收起为汉堡菜单
- [ ] 按钮大小适合触摸操作

### 手机版 (< 768px)
- [ ] 菜单收起为汉堡菜单
- [ ] 表格支持横向滚动
- [ ] 对话框和按钮适合小屏幕
- [ ] 所有功能都可以访问

---

## 性能测试

### 页面加载性能
- [ ] 页面首次加载时间 < 2 秒
- [ ] 切换标签页时响应速度快
- [ ] 加载大量数据时不会卡顿
- [ ] 表格分页切换平滑

### 网络请求
- [ ] 不会发送重复的网络请求
- [ ] 网络请求有 3 秒超时限制
- [ ] 页面卸载时会取消未完成的请求

---

## 跨浏览器兼容性测试

- [ ] Chrome 最新版本
- [ ] Firefox 最新版本
- [ ] Safari 最新版本
- [ ] Edge 最新版本
- [ ] 移动浏览器（iOS Safari、Android Chrome）

### 通用功能
- [ ] 所有按钮可以点击
- [ ] 所有表单可以填写
- [ ] 所有对话框可以交互
- [ ] 样式显示正确，没有布局问题

---

## 文件和代码检查

### 代码质量
- [ ] 没有 TypeScript 错误或警告
- [ ] 没有 ESLint 错误或警告
- [ ] 没有未使用的导入
- [ ] 没有控制台错误信息

### 文件结构
- [ ] `frontend/src/pages/admin/DataSync/index.tsx` 文件存在
- [ ] `frontend/src/components/layout/AppLayout.tsx` 正确修改
- [ ] `frontend/src/pages/admin/PriceManagement/index.tsx` 正确修改
- [ ] `frontend/src/App.tsx` 正确修改

### 导入和导出
- [ ] DataSync 组件正确导出
- [ ] DataSync 组件在 App.tsx 中正确导入
- [ ] 所有依赖项都正确导入

---

## 文档和注释

- [ ] 代码有必要的注释说明
- [ ] API 端点在代码中有说明
- [ ] 复杂的逻辑有文档说明
- [ ] 用户可以通过文档了解功能

---

## 最终验收测试

### 用户故事 1：创建日常任务
```
Given: 用户已登录
When:  用户访问数据同步页面
Then:  用户能够创建一个每日定时同步任务
And:   任务显示在任务列表中
And:   任务可以立即运行或等待定时执行
```

- [ ] 完成

### 用户故事 2：查看同步历史
```
Given: 用户已登录并创建了同步任务
When:  用户点击"同步日志"标签
Then:  用户能看到所有同步操作的历史记录
And:   能看到每次同步的详细信息（状态、耗时、数据量等）
```

- [ ] 完成

### 用户故事 3：管理数据源
```
Given: 用户已登录
When:  用户点击"数据源"标签
Then:  用户能看到所有可用的数据源
And:   能看到每个数据源的状态和最后同步时间
```

- [ ] 完成

### 用户故事 4：价格管理不受影响
```
Given: 用户已登录
When:  用户访问价格管理中心
Then:  用户只能看到三个标签页（不包括 API 自动同步）
And:   其他功能（单产品多日、多产品单日、批量导入）都正常工作
```

- [ ] 完成

---

## 签字区域

- [ ] QA 工程师确认：________________ 日期：_______
- [ ] 开发负责人确认：________________ 日期：_______
- [ ] 产品经理确认：________________ 日期：_______

---

**测试日期：** _______________  
**测试人员：** _______________  
**结果：** ☐ 通过  ☐ 失败  ☐ 有问题  

**备注：**
```
_________________________________________________________________
_________________________________________________________________
_________________________________________________________________
```

---

**修改历史：**
| 版本 | 日期 | 修改内容 |
|---|---|---|
| 1.0 | 2025-11-07 | 初始版本 |
