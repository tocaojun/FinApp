# 数据同步功能 - 快速使用指南

## 访问方式

### 菜单导航
```
系统管理 → 数据同步
```

### 直接 URL
```
http://localhost:3001/admin/data-sync
```

---

## 核心功能

### 1️⃣ 同步任务管理

#### 新建任务
```
点击 "新建任务" → 填写表单 → 确定
```

**必填字段：**
- 任务名称（如：每日基金价格同步）
- 数据源（选择 API 来源）
- 调度方式（手动/定期/定时）
- 回溯天数（历史数据范围）

**可选字段：**
- 任务描述
- 资产类型过滤
- 市场过滤

#### 编辑任务
```
点击任务行的编辑图标 → 修改配置 → 确定
```

#### 删除任务
```
点击任务行的删除图标 → 确认 → 完成
```

#### 立即运行
```
点击任务行的播放图标 → 任务开始执行
```

### 2️⃣ 调度方式说明

| 方式 | 说明 | 示例 |
|---|---|---|
| **手动** | 需要手动点击按钮触发 | - |
| **定期** | 按固定分钟间隔执行 | 60 = 每小时 |
| **定时** | 按 Cron 表达式执行 | `0 9 * * *` = 每天 9 点 |

**常用 Cron 表达式：**
```
0 9 * * *     # 每天 9 点
0 */4 * * *   # 每 4 小时
0 0 * * 1     # 每周一 0 点
0 0 1 * *     # 每月 1 号 0 点
```

### 3️⃣ 数据源查看
```
点击 "数据源" 标签 → 查看可用数据源列表
```

显示内容：
- 数据源名称
- 提供商信息
- 启用/禁用状态
- 最后同步时间

### 4️⃣ 同步日志查询
```
点击 "同步日志" 标签 → 查看执行历史
```

显示内容：
- 任务名称和数据源
- 执行状态（成功/失败/运行中）
- 处理的数据条数
- 开始时间和耗时

---

## 常见场景

### 场景 1：每天自动同步基金价格

**步骤：**
1. 点击"新建任务"
2. 填写以下信息：
   - 任务名称：`每日基金价格同步`
   - 数据源：`天天基金API`
   - 资产类型：`基金`
   - 调度方式：`定时`
   - Cron 表达式：`0 9 * * *`（每天 9 点）
   - 回溯天数：`1`
   - 覆盖已有数据：`是`
3. 点击确定

### 场景 2：每小时更新一次股票价格

**步骤：**
1. 点击"新建任务"
2. 填写以下信息：
   - 任务名称：`每小时股票价格更新`
   - 数据源：`同花顺API`
   - 资产类型：`股票`
   - 调度方式：`定期`
   - 间隔分钟数：`60`
   - 回溯天数：`0`
3. 点击确定

### 场景 3：手动补充历史数据

**步骤：**
1. 点击"新建任务"
2. 填写以下信息：
   - 任务名称：`历史数据补充 - 2024年`
   - 数据源：`天天基金API`
   - 调度方式：`手动`
   - 回溯天数：`365`（1 年的数据）
   - 覆盖已有数据：`否`（避免覆盖已有的数据）
3. 点击确定
4. 在任务列表中点击播放按钮立即运行

---

## 状态指示说明

### 任务状态
```
🟢 启用   - 任务已启用，可以自动执行
🔴 禁用   - 任务已禁用，不会自动执行
```

### 执行状态
```
✅ 成功   - 本次同步成功完成
❌ 失败   - 本次同步出现错误
⏳ 运行中  - 同步任务正在执行中
```

---

## 故障排除

### 问题：新建任务后没有显示
**解决：**
- 检查网络连接
- 刷新页面
- 查看浏览器控制台错误信息

### 问题：任务运行失败
**检查项：**
- 数据源是否启用
- API 连接是否正常
- 查看同步日志了解具体错误

### 问题：同步日志显示不完整
**解决：**
- 等待一段时间让日志加载完成
- 刷新页面
- 检查后端服务是否正常运行

---

## 重要提示

⚠️ **覆盖数据谨慎操作**
- 启用"覆盖已有数据"后，会修改现有价格数据
- 建议仅在需要更新数据时启用

⚠️ **回溯天数影响**
- 回溯天数越大，同步耗时越长
- 首次同步建议使用较小的值

⚠️ **Cron 表达式**
- 错误的 Cron 表达式会导致任务无法执行
- 测试时建议先手动运行，然后再设置自动调度

---

## 与价格管理中心的区别

| 功能 | 数据同步 | 价格管理中心 |
|---|---|---|
| **用途** | 自动化同步价格数据 | 手动录入和导入价格数据 |
| **操作方式** | 配置任务，定期自动执行 | 手动输入或上传文件 |
| **包含的操作** | - 定时同步 | - 单个产品多日录入 |
| | - 数据源管理 | - 多个产品单日录入 |
| | - 执行日志记录 | - 批量导入 |

---

## 键盘快捷键

| 操作 | 快捷键 |
|---|---|
| 切换标签 | `Tab` 键 |
| 确认对话框 | `Enter` |
| 取消对话框 | `Esc` |
| 搜索/过滤 | `Ctrl+F` |

---

## 相关文档

- 📖 [详细功能说明](./DATA_SYNC_FEATURE.md)
- 📖 [系统配置信息](./config/system-config.md)
- 📖 [完整 API 文档](./docs/API.md)

---

**最后更新：** 2025-11-07  
**版本：** 1.0
