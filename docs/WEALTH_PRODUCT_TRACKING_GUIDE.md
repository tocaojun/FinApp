# 银行理财产品投资跟踪指南

## 📋 概述

FinApp 已全面支持银行理财产品（银行理财、券商理财等）的投资跟踪，包括投资记录、收益计算、到期管理等完整功能。

## 🎯 核心功能

### ✅ 已支持的功能

1. **产品信息管理**
   - 产品基本信息（产品名称、代码、发行方）
   - 风险等级分类（R1-R5）
   - 产品类型分类（固定收益、浮动收益、结构性）

2. **投资信息跟踪**
   - 购买金额和日期
   - 预期收益率和最高/最低收益
   - 投资周期和锁定期

3. **收益管理**
   - 收益类型（年化收益、实际收益、其他）
   - 早期赎回费用
   - 到期收益计算

4. **投资组合分析**
   - 理财产品价值占比
   - 风险等级分布
   - 收益预期对比

## 📊 数据库结构

### 理财产品表（wealth_product_details）

```sql
CREATE TABLE finapp.wealth_product_details (
    id UUID PRIMARY KEY,
    asset_id UUID NOT NULL,              -- 关联资产
    
    -- 产品信息
    product_type VARCHAR(50),            -- 产品类型
    risk_level VARCHAR(20),              -- 风险等级 (R1-R5)
    
    -- 收益信息
    expected_return DECIMAL(5, 2),       -- 预期收益率 (%)
    min_return DECIMAL(5, 2),            -- 最低收益率 (%)
    max_return DECIMAL(5, 2),            -- 最高收益率 (%)
    return_type VARCHAR(50),             -- 收益类型
    
    -- 时间信息
    issue_date DATE,                     -- 发行日期
    start_date DATE,                     -- 起始日期
    maturity_date DATE,                  -- 到期日期
    lock_period INTEGER,                 -- 锁定期(天)
    
    -- 投资限制
    min_investment DECIMAL(15, 2),       -- 最小投资额
    max_investment DECIMAL(15, 2),       -- 最大投资额
    investment_increment DECIMAL(15, 2), -- 投资递增单位
    
    -- 发行方和费用
    issuer VARCHAR(200),                 -- 发行机构
    product_code VARCHAR(100),           -- 产品代码
    early_redemption BOOLEAN,            -- 支持提前赎回
    redemption_fee DECIMAL(5, 2),        -- 赎回费率 (%)
    
    created_at TIMESTAMP,
    updated_at TIMESTAMP
);
```

## 🔄 使用流程

### 步骤 1: 添加理财产品资产

在"资产管理"中添加理财产品：

```json
{
  "symbol": "ICBC-2025-11",
  "name": "工商银行2025年11月理财产品",
  "assetType": "WEALTH",
  "marketId": "CN",
  "currency": "CNY",
  "riskLevel": "MEDIUM",
  "liquidityTag": "MEDIUM",
  "description": "期限91天的固定收益理财产品"
}
```

### 步骤 2: 填写理财产品详情

```typescript
{
  productType: "fixed_income",        // 固定收益
  riskLevel: "R2",                    // 风险等级
  expectedReturn: 3.65,               // 预期年化收益 3.65%
  minReturn: 3.60,
  maxReturn: 3.70,
  returnType: "annual",               // 年化收益
  
  issueDate: "2025-11-01",
  startDate: "2025-11-05",
  maturityDate: "2026-02-04",         // 91天后到期
  lockPeriod: 5,                      // 5天锁定期
  
  minInvestment: 1000,                // 最小投资1000元
  maxInvestment: 1000000,
  investmentIncrement: 1,             // 1元递增
  
  issuer: "中国工商银行",
  productCode: "ICBC-2025-11-91",
  earlyRedemption: true,              // 支持提前赎回
  redemptionFee: 0.1                  // 赎回费0.1%
}
```

### 步骤 3: 记录投资交易

在"交易记录"中添加购买交易：

```typescript
{
  transactionType: "WEALTH_BUY",
  asset: {
    symbol: "ICBC-2025-11",
    name: "工商银行2025年11月理财产品"
  },
  quantity: 50000,                    // 投资50,000元
  unitPrice: 1,                       // 单价1元
  totalAmount: 50000,
  transactionDate: "2025-11-05",
  description: "购买工商银行理财产品",
  tags: ["银行理财", "固定收益"]
}
```

### 步骤 4: 跟踪投资状态

在"投资组合"中查看：

- ✅ 当前持仓情况
- ✅ 预期收益计算
- ✅ 到期倒计时
- ✅ 风险等级分布

## 💰 收益计算

### 预期收益计算公式

#### 方式 1: 按年化收益率计算

```
年预期收益 = 投资金额 × 年化收益率 (%)
到期收益 = 投资金额 × 年化收益率 (%) × (投资天数 / 365)
```

**示例**:
```
投资金额: 50,000 元
年化收益率: 3.65%
投资期限: 91 天

到期收益 = 50,000 × 3.65% × (91 / 365)
        = 50,000 × 0.0365 × 0.2493
        = 455.27 元

到期本息合计 = 50,000 + 455.27 = 50,455.27 元
```

#### 方式 2: 按实际期末收益率计算

如果银行在购买时已明确告知实际收益：

```
实际收益 = 投资金额 × 实际收益率

示例：
投资金额: 50,000 元
实际收益率: 1.34% (对应91天)
实际收益 = 50,000 × 1.34% = 670 元
```

## 📈 风险等级说明

| 风险等级 | 中文名称 | 说明 | 适合人群 |
|---------|---------|------|---------|
| **R1** | 低风险 | 保本保息，几乎无风险 | 保守型投资者 |
| **R2** | 低风险 | 本金无风险，收益波动小 | 保守型投资者 |
| **R3** | 中等风险 | 本金无风险，收益有波动 | 稳健型投资者 |
| **R4** | 中高风险 | 本金可能浮亏，收益较高 | 激进型投资者 |
| **R5** | 高风险 | 本金和收益都有浮亏 | 专业投资者 |

## 🔍 案例分析

### 案例 1: 固定收益产品

```
产品名称: 工商银行2025年11月理财产品
产品类型: 固定收益
风险等级: R2 (低风险)
预期收益率: 3.65% (年化)

投资信息:
├─ 投资日期: 2025-11-05
├─ 到期日期: 2026-02-04
├─ 投资期限: 91 天
├─ 投资金额: 50,000 元
├─ 锁定期: 5 天
└─ 是否支持提前赎回: 支持 (费率0.1%)

收益计算:
├─ 年化收益: 50,000 × 3.65% = 1,825 元/年
├─ 实际收益: 50,000 × 3.65% × (91/365) = 455.27 元
└─ 到期本息: 50,455.27 元

风险评估:
├─ 本金风险: 无
├─ 收益风险: 极低
├─ 流动性风险: 有 (锁定期内无法赎回)
└─ 总体风险: 低
```

### 案例 2: 浮动收益产品

```
产品名称: 招商银行月月盈理财产品
产品类型: 浮动收益
风险等级: R3 (中等风险)
预期收益范围: 2.8% - 4.2% (年化)

投资信息:
├─ 投资日期: 2025-11-05
├─ 到期日期: 2026-02-04
├─ 投资金额: 100,000 元
└─ 支持提前赎回: 支持

收益预期:
├─ 最低年预期: 100,000 × 2.8% = 2,800 元/年
├─ 最高年预期: 100,000 × 4.2% = 4,200 元/年
└─ 实际收益: 取决于市场表现

风险评估:
├─ 本金风险: 低
├─ 收益风险: 中等
├─ 流动性: 相对良好
└─ 总体风险: 中等
```

## 🎯 投资组合分析

### 理财产品占比分析

```
总资产规模: 500,000 元

资产配置:
├─ 理财产品: 200,000 元 (40%)
│  ├─ 固定收益: 150,000 元 (30%)
│  ├─ 浮动收益: 40,000 元 (8%)
│  └─ 结构性: 10,000 元 (2%)
├─ 股票: 150,000 元 (30%)
├─ 基金: 100,000 元 (20%)
└─ 债券: 50,000 元 (10%)

风险等级分布:
├─ R1-R2 (低风险): 150,000 元 (30%)
├─ R3 (中等风险): 40,000 元 (8%)
├─ R4-R5 (高风险): 10,000 元 (2%)
└─ 其他资产: 300,000 元 (60%)

预期收益分析:
├─ 理财产品年收益: 200,000 × 3.5% = 7,000 元/年
├─ 总体年收益预期: 约 18,000 元/年
└─ 年预期收益率: 约 3.6%
```

## 📅 到期管理

### 到期提醒系统

系统会自动提醒：

- ⏰ **30天前**: 初始提醒，提醒评估是否续投
- ⏰ **7天前**: 关键提醒，开始准备赎回或续投方案
- ⏰ **1天前**: 最后提醒，确认后续操作
- ⏰ **到期日**: 最终确认收益到账

### 到期后处理方案

1. **资金回收**
   - 本金自动返还到账户
   - 收益自动计入账户
   - 记录转入现金科目

2. **续投方案**
   - 本息自动续投新产品
   - 或选择其他投资品种
   - 更新投资组合配置

3. **历史记录**
   - 自动生成投资报告
   - 计算实际收益率
   - 更新历史表现数据

## 📊 主要指标

### 产品性能指标

| 指标 | 计算方式 | 说明 |
|------|---------|------|
| **年化收益率** | 实际收益 ÷ 投资额 × (365 ÷ 投资天数) | 标准化到年度的收益率 |
| **投资回报率** | (收益 ÷ 投资额) × 100% | 投资回报百分比 |
| **收益/风险比** | 预期年收益 ÷ 风险等级 | 风险调整后的收益 |
| **流动性指标** | 支持赎回 / 锁定期 | 资金流动性程度 |

### 投资组合指标

| 指标 | 计算方式 | 说明 |
|------|---------|------|
| **预期总收益** | ∑(各产品预期收益) | 全部理财产品的预期总收益 |
| **加权平均风险** | ∑(风险等级 × 占比) | 投资组合的整体风险水平 |
| **平均锁定期** | ∑(锁定期 × 占比) | 平均资金锁定时间 |
| **流动性覆盖** | 随时可赎回金额 / 总金额 | 应急资金的可用比例 |

## 🛠️ API 端点

### 添加理财产品

```bash
POST /api/assets
Content-Type: application/json

{
  "symbol": "ICBC-2025-11",
  "name": "工商银行2025年11月理财产品",
  "assetTypeId": "<WEALTH_TYPE_ID>",
  "marketId": "<CN_MARKET_ID>",
  "currency": "CNY",
  "riskLevel": "MEDIUM",
  "liquidityTag": "MEDIUM",
  "details": {
    "productType": "fixed_income",
    "riskLevel": "R2",
    "expectedReturn": 3.65,
    "issueDate": "2025-11-01",
    "startDate": "2025-11-05",
    "maturityDate": "2026-02-04"
  }
}
```

### 查询理财产品列表

```bash
GET /api/assets?assetType=WEALTH&riskLevel=R2
```

### 更新收益信息

```bash
PUT /api/assets/<assetId>/details
Content-Type: application/json

{
  "expectedReturn": 3.70,
  "actualReturnRate": 1.34
}
```

## 📝 最佳实践

### ✅ 建议做法

1. **定期评估风险**
   - 按季度检查风险等级分布
   - 确保风险等级与风险承受能力相匹配
   - 定期重新平衡投资组合

2. **追踪收益表现**
   - 对比预期收益与实际收益
   - 记录不同产品的表现差异
   - 识别高收益产品提升整体回报

3. **管理流动性风险**
   - 避免过多资金在锁定期内
   - 保留应急资金在活期账户
   - 错开到期日期以保持流动性

4. **提前规划赎回**
   - 提前30天开始评估续投方案
   - 对比不同产品的收益率
   - 避免赎回后出现资金空闲

### ❌ 避免做法

1. **忽视风险等级**
   - 不要盲目追求高收益
   - 需确保风险承受能力
   - 过度集中在高风险产品

2. **资金安排不当**
   - 不要将所有资金投入锁定期产品
   - 需保留应急准备金
   - 避免流动性压力

3. **缺乏记录**
   - 不要遗漏任何投资交易
   - 需保存所有合同和确认
   - 及时更新产品信息

## 📞 常见问题

### Q1: 理财产品到期后收益如何处理？

**A:** 系统支持两种方式：
1. 自动本息转入现金账户（默认）
2. 自动续投新的理财产品

在产品设置中可配置默认行为。

### Q2: 如何计算多只理财产品的总收益？

**A:** 系统在投资组合中自动汇总：
- 所有理财产品的预期收益之和
- 已到期产品的实际收益
- 按风险等级加权计算

### Q3: 提前赎回会影响收益吗？

**A:** 是的，提前赎回通常会：
1. 按实际天数计算利息（通常较低）
2. 扣除赎回费用（如有）
3. 具体规则以产品条款为准

### Q4: 如何对比不同理财产品？

**A:** 在产品列表中可按以下维度对比：
- 预期收益率
- 投资期限
- 风险等级
- 是否支持提前赎回
- 赎回费用率

### Q5: 理财产品收益需要交税吗？

**A:** 根据中国税法：
- 利息收入：按国债利息税率（通常为0%）
- 具体税务处理应咨询专业税务顾问

## 📚 相关功能

- **交易记录**: 详细的购买和赎回记录
- **投资组合**: 实时查看理财产品占比和预期收益
- **资产详情**: 完整的产品信息和风险分析
- **报表系统**: 生成投资收益报告和税务报告

## 🎓 学习资源

- 银行理财产品基础知识
- 理财产品风险评估方法
- 投资组合优化策略
- 税务和法律相关信息

---

**文档版本**: v1.0  
**更新日期**: 2025-11-08  
**适用版本**: FinApp v1.0+
