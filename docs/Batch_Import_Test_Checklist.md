# 价格批量导入功能测试清单

## 📋 测试概述

**测试范围：** 价格批量导入功能（Phase 2）  
**测试日期：** 2025-10-26  
**测试环境：** 开发环境  
**测试账号：** testapi@finapp.com

## ✅ 功能测试

### 1. 模板下载

- [ ] 点击"下载导入模板"按钮
- [ ] 验证下载的文件名为"价格导入模板.xlsx"
- [ ] 打开模板文件，检查表头字段
  - [ ] 产品代码
  - [ ] 产品名称
  - [ ] 价格日期
  - [ ] 收盘价
  - [ ] 开盘价
  - [ ] 最高价
  - [ ] 最低价
  - [ ] 币种
- [ ] 检查模板中是否包含示例数据（3条）
- [ ] 验证列宽设置是否合理

### 2. 文件上传

#### 2.1 正常上传
- [ ] 选择正确格式的 Excel 文件（.xlsx）
- [ ] 验证文件上传成功
- [ ] 检查是否显示加载状态
- [ ] 验证是否自动进入验证步骤

#### 2.2 文件格式验证
- [ ] 尝试上传非 Excel 文件（如 .txt, .pdf）
- [ ] 验证是否显示错误提示："只能上传 Excel 文件！"
- [ ] 尝试上传 .xls 格式文件
- [ ] 验证是否能正常解析

#### 2.3 文件大小验证
- [ ] 尝试上传超过 5MB 的文件
- [ ] 验证是否显示错误提示："文件大小不能超过 5MB！"

#### 2.4 数据量验证
- [ ] 上传包含 0 条数据的文件
- [ ] 验证是否显示错误提示："文件中没有数据"
- [ ] 上传包含超过 1000 条数据的文件
- [ ] 验证是否显示错误提示："单次导入不能超过 1000 条记录"

### 3. 数据验证

#### 3.1 产品代码验证
- [ ] 上传包含存在的产品代码的数据
- [ ] 验证记录状态为"有效"
- [ ] 验证产品名称自动填充
- [ ] 上传包含不存在的产品代码的数据
- [ ] 验证记录状态为"错误"
- [ ] 验证错误信息："产品代码 XXX 不存在"
- [ ] 上传产品代码为空的数据
- [ ] 验证错误信息："产品代码不能为空"

#### 3.2 日期验证
- [ ] 上传正确日期格式（YYYY-MM-DD）的数据
- [ ] 验证记录状态为"有效"
- [ ] 上传错误日期格式的数据（如 2025/01/15）
- [ ] 验证错误信息："价格日期格式无效"
- [ ] 上传日期为空的数据
- [ ] 验证错误信息："价格日期不能为空"
- [ ] 上传无效日期（如 2025-13-45）
- [ ] 验证错误信息："价格日期格式无效"

#### 3.3 收盘价验证
- [ ] 上传收盘价 > 0 的数据
- [ ] 验证记录状态为"有效"
- [ ] 上传收盘价 = 0 的数据
- [ ] 验证错误信息："收盘价必须大于0"
- [ ] 上传收盘价 < 0 的数据
- [ ] 验证错误信息："收盘价必须大于0"
- [ ] 上传收盘价为空的数据
- [ ] 验证错误信息："收盘价必须大于0"

#### 3.4 价格逻辑验证
- [ ] 上传最高价 < 最低价的数据
- [ ] 验证错误信息："最高价不能低于最低价"
- [ ] 上传收盘价 > 最高价的数据
- [ ] 验证错误信息："收盘价应在最高价和最低价之间"
- [ ] 上传收盘价 < 最低价的数据
- [ ] 验证错误信息："收盘价应在最高价和最低价之间"
- [ ] 上传开盘价 > 最高价的数据
- [ ] 验证错误信息："开盘价应在最高价和最低价之间"
- [ ] 上传开盘价 < 最低价的数据
- [ ] 验证错误信息："开盘价应在最高价和最低价之间"

#### 3.5 可选字段验证
- [ ] 上传只包含必填字段的数据（产品代码、日期、收盘价）
- [ ] 验证记录状态为"有效"
- [ ] 上传包含所有字段的数据
- [ ] 验证记录状态为"有效"
- [ ] 上传币种为空的数据
- [ ] 验证是否使用产品默认币种

### 4. 验证结果展示

#### 4.1 统计信息
- [ ] 验证"总记录数"显示正确
- [ ] 验证"有效记录"数量正确
- [ ] 验证"无效记录"数量正确
- [ ] 验证"有效率"计算正确
- [ ] 验证统计卡片颜色：
  - [ ] 总记录数：蓝色
  - [ ] 有效记录：绿色
  - [ ] 无效记录：红色
  - [ ] 有效率：绿色（100%）或黄色（<100%）

#### 4.2 数据表格
- [ ] 验证表格显示所有记录
- [ ] 验证列显示正确：
  - [ ] 行号
  - [ ] 状态（有效/错误/待验证）
  - [ ] 产品代码
  - [ ] 产品名称
  - [ ] 价格日期
  - [ ] 收盘价（4位小数）
  - [ ] 开盘价（4位小数或"-"）
  - [ ] 最高价（4位小数或"-"）
  - [ ] 最低价（4位小数或"-"）
  - [ ] 币种
  - [ ] 错误信息
- [ ] 验证状态图标：
  - [ ] 有效：绿色对勾
  - [ ] 错误：红色叉号
  - [ ] 待验证：黄色感叹号
- [ ] 验证错误信息以红色文字显示
- [ ] 验证表格支持横向滚动
- [ ] 验证表格支持分页（每页20条）

#### 4.3 警告提示
- [ ] 当有无效记录时，验证是否显示警告提示
- [ ] 验证警告内容："发现无效记录，请检查下方标记为错误的记录"

### 5. 数据导入

#### 5.1 导入按钮状态
- [ ] 当有效记录数 = 0 时，验证导入按钮是否禁用
- [ ] 当有效记录数 > 0 时，验证导入按钮是否启用
- [ ] 验证按钮文字显示有效记录数："导入 X 条有效记录"

#### 5.2 导入确认
- [ ] 点击导入按钮
- [ ] 验证是否显示确认对话框
- [ ] 验证对话框内容："确定要导入 X 条价格记录吗？"
- [ ] 点击"取消"，验证是否关闭对话框且不导入
- [ ] 点击"确定"，验证是否开始导入

#### 5.3 导入过程
- [ ] 验证导入时显示加载状态
- [ ] 验证导入按钮显示加载动画
- [ ] 验证导入成功后显示成功消息
- [ ] 验证成功消息内容："成功导入 X 条价格记录"
- [ ] 验证导入成功后自动进入完成步骤

#### 5.4 导入失败处理
- [ ] 模拟网络错误（断网）
- [ ] 验证是否显示错误消息
- [ ] 模拟权限错误
- [ ] 验证是否显示权限错误消息
- [ ] 模拟服务器错误
- [ ] 验证是否显示服务器错误消息

### 6. 导入完成

- [ ] 验证显示成功图标（绿色对勾）
- [ ] 验证显示成功标题："导入成功！"
- [ ] 验证显示导入数量："已成功导入 X 条价格记录"
- [ ] 验证显示"继续导入"按钮
- [ ] 点击"继续导入"，验证是否返回第一步

### 7. 步骤导航

- [ ] 验证步骤条显示3个步骤：
  1. 上传文件
  2. 数据验证
  3. 导入完成
- [ ] 验证当前步骤高亮显示
- [ ] 验证已完成步骤显示对勾
- [ ] 验证步骤描述显示正确

### 8. 重新上传

- [ ] 在验证步骤点击"重新上传"按钮
- [ ] 验证是否返回第一步
- [ ] 验证数据是否清空
- [ ] 验证统计信息是否重置

## 🔍 边界测试

### 1. 数据量测试
- [ ] 上传 1 条记录
- [ ] 上传 100 条记录
- [ ] 上传 500 条记录
- [ ] 上传 1000 条记录（最大值）
- [ ] 验证每种情况下的性能表现

### 2. 特殊字符测试
- [ ] 产品代码包含特殊字符（如 @, #, $）
- [ ] 产品名称包含中文、英文、数字混合
- [ ] 产品名称包含特殊字符

### 3. 精度测试
- [ ] 价格包含 1 位小数
- [ ] 价格包含 2 位小数
- [ ] 价格包含 3 位小数
- [ ] 价格包含 4 位小数
- [ ] 价格包含超过 4 位小数（验证是否正确处理）

### 4. 混合数据测试
- [ ] 上传包含有效和无效记录的混合数据
- [ ] 验证统计信息正确
- [ ] 验证只导入有效记录

## 🎨 UI/UX 测试

### 1. 响应式布局
- [ ] 在不同屏幕尺寸下测试（1920x1080, 1366x768, 1024x768）
- [ ] 验证布局是否合理
- [ ] 验证表格是否支持横向滚动

### 2. 加载状态
- [ ] 验证文件上传时显示加载动画
- [ ] 验证数据验证时显示加载动画
- [ ] 验证数据导入时显示加载动画

### 3. 错误提示
- [ ] 验证错误消息显示位置合理
- [ ] 验证错误消息内容清晰
- [ ] 验证错误消息自动消失

### 4. 交互反馈
- [ ] 验证按钮悬停效果
- [ ] 验证按钮点击效果
- [ ] 验证表格行悬停效果

## 🔐 权限测试

- [ ] 使用有导入权限的账号测试
- [ ] 验证功能正常
- [ ] 使用无导入权限的账号测试
- [ ] 验证是否显示权限错误

## 📊 性能测试

### 1. 文件解析性能
- [ ] 测试解析 100 条记录的时间
- [ ] 测试解析 500 条记录的时间
- [ ] 测试解析 1000 条记录的时间
- [ ] 验证解析时间是否在可接受范围内（< 5秒）

### 2. 数据验证性能
- [ ] 测试验证 100 条记录的时间
- [ ] 测试验证 500 条记录的时间
- [ ] 测试验证 1000 条记录的时间
- [ ] 验证验证时间是否在可接受范围内（< 10秒）

### 3. 数据导入性能
- [ ] 测试导入 100 条记录的时间
- [ ] 测试导入 500 条记录的时间
- [ ] 测试导入 1000 条记录的时间
- [ ] 验证导入时间是否在可接受范围内（< 30秒）

## 🐛 错误处理测试

### 1. 网络错误
- [ ] 断网后尝试验证数据
- [ ] 验证错误提示
- [ ] 断网后尝试导入数据
- [ ] 验证错误提示

### 2. 服务器错误
- [ ] 模拟服务器 500 错误
- [ ] 验证错误提示
- [ ] 模拟服务器超时
- [ ] 验证错误提示

### 3. 数据错误
- [ ] 上传损坏的 Excel 文件
- [ ] 验证错误提示："解析文件失败"
- [ ] 上传修改过表头的文件
- [ ] 验证是否能正确处理

## ✅ 测试结果

### 通过标准
- [ ] 所有功能测试通过
- [ ] 所有边界测试通过
- [ ] UI/UX 测试通过
- [ ] 权限测试通过
- [ ] 性能测试通过
- [ ] 错误处理测试通过

### 发现的问题
（记录测试过程中发现的问题）

1. 
2. 
3. 

### 测试总结
（总结测试结果和建议）

---

**测试人员：** ___________  
**测试日期：** ___________  
**测试结果：** ☐ 通过 ☐ 不通过  
**备注：** ___________
